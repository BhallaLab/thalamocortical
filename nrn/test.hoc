objectvar vecT, vecV, stim1, outfile, cad_file, vec_cad
outfile = new File()
vecV = new Vector()
vecT = new Vector()
vec_cad = new Vector()
FARADAY=96485
PI=3.141592
secondorder=2
dt=1e-3
celsius=30
create soma
access soma
v_init=-65
soma{
    nseg = 1
    diam = 15
    L = 20
    
    insert naf
    gbar_naf = 0.15
    ena = 50
    // insert kdr_fs
    // gbar_kdr_fs = 0.1
    // insert ka_ib
    // gbar_ka_ib = 0.03
    // insert km
    // gbar_km = 0.00375
    // ek = -95
    insert cal
    gbar_cal = 5e-4
    insert cat
    gbar_cat = 1e-4
    insert cad
//    *** ca diffusion: beta=1/tau
    beta_cad  =   0.02
    // cafor(I) (FORTRAN) converted to phi (NEURON)
    phi_cad =   260000.
//    eca = 125e-3
    insert pas
    e_pas = -65
    g_pas = 2e-5
    Ra = 250
    cm = 0.9

    stim1 = new IClamp(0.5)
    stim1.amp = 0.1
    stim1.dur = 20
    stim1.del = 20
}
ceiling_cad = 1e6
tstop = 50
vecV.record(&soma.v(0.5))
vecT.record(&t)
vec_cad.record(&soma.cai(0.5))
run()
outfile.wopen("mydata/Vm.plot")
for ii = 0, vecV.size() - 1 {
    outfile.printf("%g %g %g\n", vecT.x(ii), vecV.x(ii), vec_cad.x(ii))

}
outfile.close()

